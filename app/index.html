<!doctype html>
<html ng-app="stories">
    <head>
        <title>the simple taskboard</title>

        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

        <link rel="stylesheet" href="styles/main.css">
    </head>
    <body>
        <form name="allStories" ng-controller="StoryController">
            <div class="headlineContainer">
                <h1>the simple taskboard</h1>

                <ul class="modificators">
                    <li class="sortingContainer buttonDecoration">
                        <pre class="icon iconDark iconFilter" alt="Order by" title="Order by"></pre>
                        <select ng-Model="orderProp" alt="Order by" title="Order by">
                            <option value="-time">Age</option>
                            <option value="priority">Priority</option>
                        </select>
                    </li>

                    <li class="filterContainer buttonDecoration">
                        <pre class="icon iconDark iconPerson" alt="Filter by assignee" title="Filter by assignee"></pre>
                        <select ng-Model="filterProp" alt="Filter by assignee" title="Filter by assignee">
                            <option ng-repeat="assignee in assignees" ng-model="assignee.name" value="{{assignee.name}}">{{assignee.name}}</option>
                        </select>
                        <a href="#/resetFilter" ng-click="resetFilter()">
                            <pre class="icon iconDark iconReset" alt="Reset filter" title="Reset Filter"></pre>
                        </a>
                    </li>
                </ul>
            </div>

            <a id="addStoryButton" class="iconButton buttonDecoration" href="#/story/add" ng-click="newStory.triggerDialog()">
                <pre class="icon iconDark iconPlus" alt="add new story" title="add new story"></pre>
                <span>add new story</span>
            </a>

            <div class="addStoryContainer" ng-hide="newStory.hidden">
                <h3>Add a new story</h3>
                <label for="storyName">Name of the story: </label>
                <input id="storyName" class="textField" type="text" ng-model="newStory.name" />

                <br />

                <span>Story priority (1 = Max, 5 = Min):</span>

                <fieldset id=storyPriority">
                    <input type="radio" name="priority" value="1" ng-model="newStory.priority">1</input>
                    <input type="radio" name="priority" value="2" ng-model="newStory.priority">2</input>
                    <input type="radio" name="priority" value="3" ng-model="newStory.priority">3</input>
                    <input type="radio" name="priority" value="4" ng-model="newStory.priority">4</input>
                    <input type="radio" name="priority" value="5" ng-model="newStory.priority">5</input>
                </fieldset>

                <a class="buttonDecoration addButtonCentered" value="Add" ng-click="newStory.add()">
                    <pre class="icon iconDark iconOk" alt="add" title="add"></pre>
                    <span>Add</span>
                </a>
            </div>

            <div class="addTaskContainer" ng-hide="newTask.hidden">
                <h3>Add new task for story <strong>{{newTask.story.name}}</strong></h3>

                <label for="taskTitle">Task description:</label>
                <input id="taskTitle" class="textField" type="text" ng-model="newTask.title" />

                <label for="taskAssignee">Assignee for this task:</label>
                <input id="taskAssignee" class="textField" type="text" ng-model="newTask.assignee" />

                <label for="taskEstimate">Estimated time:</label>
                <input id="taskEstimate" class="textSmallField" type="text" ng-model="newTask.estimate" />

                <a class="buttonDecoration addButtonCentered" value="Add" ng-click="newTask.add(newTask)">
                    <pre class="icon iconDark iconOk" alt="add" title="add"></pre>
                    <span>Add</span>
                </a>
            </div>

            <!-- Header for story status -->
            <ul class="storyStatus">
                <li>ToDo ({{tasksUndone}})</li>
                <li>Progressing ({{tasksProgressing}})</li>
                <li>Resolved ({{tasksResolved}})</li>
            </ul>

            <!-- Placeholder for potential dragging targets -->
            <ul class="taskTargets">
                <li id="taskTargetToDo" class="taskTarget" ng-hide="taskTargets.targetToDo.hidden" droppable></li>
                <li id="taskTargetProgress" class="taskTarget" ng-hide="taskTargets.targetProgress.hidden" droppable></li>
                <li id="taskTargetResolved" class="taskTarget" ng-hide="taskTargets.targetResolved.hidden" droppable></li>
           </ul>

            <div class="dropzone" droppable>
                <div class="storyContainer" ng-repeat="story in stories | orderBy:orderProp">
                    <a href="#/story/{{story.id}}/collapse" class="{{story.state}}Icon" title="{{story.state}}" ng-click="changeStoryState(story)"></a>
                    <h2>Story <strong>{{story.name}}</strong> ({{story.tasks.length || 0}} tasks, {{getRemainingTime(story)}} remaining days)</h2>
                    <a class="addTaskButton buttonDecorationSmall {{story.state}}" href="#/story/{{story.id}}/addTask" ng-click="newTask.triggerDialog(story)">
                        <pre class="icon iconDark iconPlus" alt="add new task" title="add new task"></pre></a>
                    <a class="deleteStoryButton buttonDecorationSmall {{story.state}}" href="#/story/{{story.id}}/delete" ng-click="deleteStory(story)">
                        <pre class="icon iconDark iconDelete" alt="delete this story" title="delete this story"></pre></a>
                    <ul class="story {{story.state}} borderPriority{{story.priority}}">
                        <li class="task" ng-repeat="task in story.tasks | filter:filterProp">
                            <div id="task{{task.id}}" class="item itemStatus{{task.status}}" draggable>
                                <textarea ng-model="task.title" ng-change="taskUpdated(task)">{{task.title}}</textarea>

                                <br />
                                <span>Assignee: <strong>{{task.assignee}}</strong></span>

                                <br />
                                <span>Remaining time: <strong><input class="inputTaskEstimate" type="text" ng-model="task.estimate" ng-change="taskEstimateUpdated()" /></strong></span>

                                <a class="deleteTaskButton buttonDecorationSmall" href="#/task/{{task.id}}/delete" ng-click="deleteTask(task, $index)">
                                    <pre class="icon iconDark iconDelete" alt="delete this task" title="delete this task"></pre>
                                </a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="cover" ng-hide="newStory.hidden && newTask.hidden" ng-animate="{show: 'fade-show', hide: 'fade-hide'}"></div>

        </form>

        <script type="text/javascript" src="bower_components/angular/angular.js"></script>
        <script type="text/javascript" src="bower_components/jquery/jquery.js"></script>
        <script type="text/javascript" src="bower_components/underscore/underscore.js"></script>
        <script type="text/javascript" src="scripts/app.js"></script>
        <script type="text/javascript" src="scripts/controllers.js"></script>
        <script type="text/javascript" src="scripts/providers.js"></script>
        <script type="text/javascript" src="scripts/directives.js"></script>
        <script type="text/javascript" src="scripts/helpers.js"></script>
        <script type="text/javascript" src="scripts/stories.js"></script>
        <script type="text/javascript" src="scripts/tasks.js"></script>
        <script type="text/javascript" src="scripts/assignees.js"></script>
</body>
</html>
